# ============================================================
# ðŸŽ­ PNJ Anonymous Bot â€” Production Override
# ============================================================
# Usage: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
# ============================================================

services:
  pnj-bot:
    restart: always

    environment:
      - BOT_DEBUG=false

    # Stricter resource limits for production
    deploy:
      resources:
        limits:
          cpus: "2.0"
          memory: 512M
        reservations:
          cpus: "0.5"
          memory: 128M

    # Production logging â€” send to stderr/stdout for log aggregators
    logging:
      driver: "json-file"
      options:
        max-size: "50m"
        max-file: "10"
        tag: "pnj-bot-prod"

  # â”€â”€ Optional: Watchtower for auto-update â”€â”€
  watchtower:
    image: containrrr/watchtower:latest
    container_name: pnj-bot-watchtower
    profiles:
      - watchtower
    restart: "no"
    command:
      - --run-once
      - --cleanup
      - --label-enable
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
